!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.backand=e()}}(function(){var e;return function e(t,n,r){function o(s,i){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!i&&u)return u(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var a="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,n,r){(function(o,a){!function(t,o){"object"==typeof r&&"undefined"!=typeof n?n.exports=o():"function"==typeof e&&e.amd?e(o):t.ES6Promise=o()}(this,function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function n(e){return"function"==typeof e}function r(e){X=e}function s(e){Y=e}function i(){return function(){return o.nextTick(d)}}function u(){return"undefined"!=typeof B?function(){B(d)}:f()}function c(){var e=0,t=new $(d),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function l(){var e=new MessageChannel;return e.port1.onmessage=d,function(){return e.port2.postMessage(0)}}function f(){var e=setTimeout;return function(){return e(d,1)}}function d(){for(var e=0;e<F;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}F=0}function h(){try{var e=t,n=e("vertx");return B=n.runOnLoop||n.runOnContext,u()}catch(e){return f()}}function p(e,t){var n=arguments,r=this,o=new this.constructor(v);void 0===o[oe]&&L(o);var a=r._state;return a?!function(){var e=n[a-1];Y(function(){return A(a,o,e,r._result)})}():P(r,o,e,t),o}function m(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(v);return S(n,e),n}function v(){}function g(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function b(e){try{return e.then}catch(e){return ue.error=e,ue}}function w(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}function k(e,t,n){Y(function(e){var r=!1,o=w(n,t,function(n){r||(r=!0,t!==n?S(e,n):O(e,n))},function(t){r||(r=!0,N(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,N(e,o))},e)}function _(e,t){t._state===se?O(e,t._result):t._state===ie?N(e,t._result):P(t,void 0,function(t){return S(e,t)},function(t){return N(e,t)})}function T(e,t,r){t.constructor===e.constructor&&r===p&&t.constructor.resolve===m?_(e,t):r===ue?N(e,ue.error):void 0===r?O(e,t):n(r)?k(e,t,r):O(e,t)}function S(t,n){t===n?N(t,g()):e(n)?T(t,n,b(n)):O(t,n)}function E(e){e._onerror&&e._onerror(e._result),I(e)}function O(e,t){e._state===ae&&(e._result=t,e._state=se,0!==e._subscribers.length&&Y(I,e))}function N(e,t){e._state===ae&&(e._state=ie,e._result=t,Y(E,e))}function P(e,t,n,r){var o=e._subscribers,a=o.length;e._onerror=null,o[a]=t,o[a+se]=n,o[a+ie]=r,0===a&&e._state&&Y(I,e)}function I(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,a=e._result,s=0;s<t.length;s+=3)r=t[s],o=t[s+n],r?A(n,r,o,a):o(a);e._subscribers.length=0}}function R(){this.error=null}function j(e,t){try{return e(t)}catch(e){return ce.error=e,ce}}function A(e,t,r,o){var a=n(r),s=void 0,i=void 0,u=void 0,c=void 0;if(a){if(s=j(r,o),s===ce?(c=!0,i=s.error,s=null):u=!0,t===s)return void N(t,y())}else s=o,u=!0;t._state!==ae||(a&&u?S(t,s):c?N(t,i):e===se?O(t,s):e===ie&&N(t,s))}function U(e,t){try{t(function(t){S(e,t)},function(t){N(e,t)})}catch(t){N(e,t)}}function q(){return le++}function L(e){e[oe]=le++,e._state=void 0,e._result=void 0,e._subscribers=[]}function x(e,t){this._instanceConstructor=e,this.promise=new e(v),this.promise[oe]||L(this.promise),W(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?O(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&O(this.promise,this._result))):N(this.promise,C())}function C(){return new Error("Array Methods must be provided an Array")}function M(e){return new x(this,e).promise}function G(e){var t=this;return new t(W(e)?function(n,r){for(var o=e.length,a=0;a<o;a++)t.resolve(e[a]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function D(e){var t=this,n=new t(v);return N(n,e),n}function V(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function H(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function J(e){this[oe]=q(),this._result=this._state=void 0,this._subscribers=[],v!==e&&("function"!=typeof e&&V(),this instanceof J?U(this,e):H())}function z(){var e=void 0;if("undefined"!=typeof a)e=a;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=J}var K=void 0;K=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var W=K,F=0,B=void 0,X=void 0,Y=function(e,t){ne[F]=e,ne[F+1]=t,F+=2,2===F&&(X?X(d):re())},Q="undefined"!=typeof window?window:void 0,Z=Q||{},$=Z.MutationObserver||Z.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof o&&"[object process]"==={}.toString.call(o),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),re=void 0;re=ee?i():$?c():te?l():void 0===Q&&"function"==typeof t?h():f();var oe=Math.random().toString(36).substring(16),ae=void 0,se=1,ie=2,ue=new R,ce=new R,le=0;return x.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===ae&&n<e;n++)this._eachEntry(t[n],n)},x.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===m){var o=b(e);if(o===p&&e._state!==ae)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===J){var a=new n(v);T(a,e,o),this._willSettleAt(a,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},x.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===ae&&(this._remaining--,e===ie?N(r,n):this._result[t]=n),0===this._remaining&&O(r,this._result)},x.prototype._willSettleAt=function(e,t){var n=this;P(e,void 0,function(e){return n._settledAt(se,t,e)},function(e){return n._settledAt(ie,t,e)})},J.all=M,J.race=G,J.resolve=m,J.reject=D,J._setScheduler=r,J._setAsap=s,J._asap=Y,J.prototype={constructor:J,then:p,catch:function(e){return this.then(null,e)}},J.polyfill=z,J.Promise=J,J})}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2}],2:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(f===setTimeout)return setTimeout(e,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function s(e){if(d===clearTimeout)return clearTimeout(e);if((d===o||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function i(){v&&p&&(v=!1,p.length?m=p.concat(m):g=-1,m.length&&u())}function u(){if(!v){var e=a(i);v=!0;for(var t=m.length;t;){for(p=m,m=[];++g<t;)p&&p[g].run();g=-1,t=m.length}p=null,v=!1,s(e)}}function c(e,t){this.fun=e,this.array=t}function l(){}var f,d,h=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(e){f=r}try{d="function"==typeof clearTimeout?clearTimeout:o}catch(e){d=o}}();var p,m=[],v=!1,g=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new c(e,t)),1!==m.length||v||a(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=l,h.addListener=l,h.once=l,h.off=l,h.removeListener=l,h.removeAllListeners=l,h.emit=l,h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.EVENTS={SIGNIN:"SIGNIN",SIGNOUT:"SIGNOUT",SIGNUP:"SIGNUP"},n.URLS={token:"token",signup:"1/user/signup",requestResetPassword:"1/user/requestResetPassword",resetPassword:"1/user/resetPassword",changePassword:"1/user/changePassword",socialSigninWithToken:"1/user/PROVIDER/token",signout:"1/user/signout",profile:"api/account/profile",objects:"1/objects",objectsAction:"1/objects/action",query:"1/query/data"},n.SOCIAL_PROVIDERS={github:{name:"github",label:"Github",url:"www.github.com",css:{backgroundColor:"#444"},id:1},google:{name:"google",label:"Google",url:"www.google.com",css:{backgroundColor:"#dd4b39"},id:2},facebook:{name:"facebook",label:"Facebook",url:"www.facebook.com",css:{backgroundColor:"#3b5998"},id:3},twitter:{name:"twitter",label:"Twitter",url:"www.twitter.com",css:{backgroundColor:"#55acee"},id:4}}},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={appName:null,anonymousToken:null,signUpToken:null,apiUrl:"https://api.backand.com",storage:window.localStorage,storagePrefix:"BACKAND_",manageRefreshToken:!0,runSigninAfterSignup:!0,runSocket:!1,socketUrl:"https://socket.backand.com",isMobile:!1}},{}],5:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n.filter={create:function(e,t,n){return{fieldName:e,operator:t,value:n}},operators:{numeric:{equals:"equals",notEquals:"notEquals",greaterThan:"greaterThan",greaterThanOrEqualsTo:"greaterThanOrEqualsTo",lessThan:"lessThan",lessThanOrEqualsTo:"lessThanOrEqualsTo",empty:"empty",notEmpty:"notEmpty"},date:{equals:"equals",notEquals:"notEquals",greaterThan:"greaterThan",greaterThanOrEqualsTo:"greaterThanOrEqualsTo",lessThan:"lessThan",lessThanOrEqualsTo:"lessThanOrEqualsTo",empty:"empty",notEmpty:"notEmpty"},text:{equals:"equals",notEquals:"notEquals",startsWith:"startsWith",endsWith:"endsWith",contains:"contains",notContains:"notContains",empty:"empty",notEmpty:"notEmpty"},boolean:{equals:"equals"},relation:{in:"in"}}},n.sort={create:function(e,t){return{fieldName:e,order:t}},orders:{asc:"asc",desc:"desc"}},n.exclude={options:{metadata:"metadata",totalRows:"totalRows",all:"metadata,totalRows"}},n.StorageAbstract=function(){function e(){if(r(this,e),this.constructor===e)throw new TypeError("Can not construct abstract class.");if(void 0===this.setItem||this.setItem===e.prototype.setItem)throw new TypeError("Must override setItem method.");if(void 0===this.getItem||this.getItem===e.prototype.getItem)throw new TypeError("Must override getItem method.");if(void 0===this.removeItem||this.removeItem===e.prototype.removeItem)throw new TypeError("Must override removeItem method.");if(void 0===this.clear||this.clear===e.prototype.clear)throw new TypeError("Must override clear method.")}return o(e,[{key:"setItem",value:function(e,t){throw new TypeError("Do not call abstract method setItem from child.")}},{key:"getItem",value:function(e){throw new TypeError("Do not call abstract method getItem from child.")}},{key:"removeItem",value:function(e){throw new TypeError("Do not call abstract method removeItem from child.")}},{key:"clear",value:function(){throw new TypeError("Do not call abstract method clear from child.")}}]),e}()},{}],6:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=e("./defaults"),i=o(s),u=e("./constants"),c=r(u),l=e("./helpers"),f=r(l),d=e("./utils/storage"),h=o(d),p=e("./utils/http"),m=o(p),v=e("./utils/socket"),g=o(v),y=e("./services/auth"),b=o(y),w=e("./services/object"),k=o(w),_=e("./services/file"),T=o(_),S=e("./services/query"),E=o(S),O=e("./services/user"),N=o(O),P={constants:c,helpers:f};P.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(a(i.default,e),!i.default.appName)throw new Error("appName is missing");if(!i.default.anonymousToken)throw new Error("anonymousToken is missing");if(!i.default.signUpToken)throw new Error("signUpToken is missing");var t={storage:new h.default(i.default.storage,i.default.storagePrefix),http:m.default.create({baseURL:i.default.apiUrl}),isIE:window.document&&!!document.documentMode,ENV:"browser"};if(i.default.runSocket&&(t.socket=new g.default(i.default.socketUrl)),t.http.config.interceptors={request:function(e){e.url.indexOf(c.URLS.token)===-1&&P.utils.storage.get("user")&&(e.headers=a({},e.headers,P.utils.storage.get("user").token))},responseError:function(e,n,r,o,a,s){n.url.indexOf(c.URLS.token)===-1&&i.default.manageRefreshToken&&401===e.status&&e.data&&"invalid or expired token"===e.data.Message?b.default.__handleRefreshToken__.call(t,e).then(function(e){P.utils.http.request(n,a,s)}).catch(function(e){s&&s(e),o(e)}):(s&&s(e),o(e))}},delete P.init,a(P,b.default,{object:k.default,file:T.default,query:E.default,user:N.default,utils:t}),i.default.runSocket&&(P.utils.storage.get("user")&&P.utils.socket.connect(P.utils.storage.get("user").token.Authorization||null,i.default.anonymousToken,i.default.appName),a(P,{on:P.utils.socket.on.bind(P.utils.socket)})),!i.default.isMobile){var n=/\?(data|error)=(.+)/.exec(window.location.href);if(n&&n[1]&&n[2]){var r={data:JSON.parse(decodeURIComponent(n[2].replace(/#.*/,"")))};r.status="data"===n[1]?200:0,localStorage.setItem("SOCIAL_DATA",JSON.stringify(r))}}},t.exports=P},{"./constants":3,"./defaults":4,"./helpers":5,"./services/auth":7,"./services/file":8,"./services/object":9,"./services/query":10,"./services/user":11,"./utils/http":12,"./utils/socket":13,"./utils/storage":14}],7:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return{status:e,statusText:t,headers:n,data:r}}function a(e){var t=void 0;E.default.isMobile||(document.createEvent?(t=document.createEvent("Event"),t.initEvent(e,!0,!0),t.eventName=e,window.dispatchEvent(t)):(t=document.createEventObject(),t.eventType=e,t.eventName=e,window.fireEvent("on"+t.eventType,t)))}function s(e){return new _.Promise(function(e,t){var n=backand.utils.storage.get("user");n&&n.details.refresh_token?m({username:n.details.username,refreshToken:n.details.refresh_token}).then(function(t){e(t)}).catch(function(e){t(e)}):t(o(0,"",[],"No cached user or refreshToken found. authentication is required."))})}function i(e){return new _.Promise(function(t,n){var r={access_token:E.default.anonymousToken,token_type:"AnonymousToken",expires_in:0,appName:E.default.appName,username:"Guest",role:"User",firstName:"anonymous",lastName:"anonymous",fullName:"",regId:0,userId:null};backand.utils.storage.set("user",{token:{AnonymousToken:E.default.anonymousToken},details:r}),a(T.EVENTS.SIGNIN),E.default.runSocket&&backand.utils.socket.connect(null,E.default.anonymousToken,E.default.appName),e&&e(o(200,"OK",[],r)),t(o(200,"OK",[],r))})}function u(e,t,n,r){return new _.Promise(function(o,s){backand.utils.http({url:T.URLS.token,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"username="+e+"&password="+t+"&appName="+E.default.appName+"&grant_type=password"}).then(function(e){backand.utils.storage.set("user",{token:{Authorization:"Bearer "+e.data.access_token},details:e.data}),a(T.EVENTS.SIGNIN),E.default.runSocket&&backand.utils.socket.connect(backand.utils.storage.get("user").token.Authorization,E.default.anonymousToken,E.default.appName),n&&n(e),o(e)}).catch(function(e){r&&r(e),s(e)})})}function c(e,t,n,r,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},i=arguments[6],c=arguments[7];return new _.Promise(function(l,f){backand.utils.http({url:T.URLS.signup,method:"POST",headers:{SignUpToken:E.default.signUpToken},data:{firstName:r,lastName:o,email:e,password:t,confirmPassword:n,parameters:s}},i,c).then(function(e){return a(T.EVENTS.SIGNUP),E.default.runSigninAfterSignup?u(e.data.username,t):(i&&i(e),void l(e))}).then(function(e){i&&i(e),l(e)}).catch(function(e){c&&c(e),f(e)})})}function l(e,t,n){var r=T.SOCIAL_PROVIDERS[e],o=t?"up":"in",a="&signupIfNotSignedIn="+(!t&&n?"true":"false");return"/user/socialSign"+o+"?provider="+r.label+a+"&response_type=token&client_id=self&redirect_uri="+r.url+"&state="}function f(e,t,n,r){return new _.Promise(function(a,s){T.SOCIAL_PROVIDERS[e]||s(o(0,"",[],"Unknown Social Provider"));var i=E.default.apiUrl+"/1/"+l(e,t,!0)+"&appname="+E.default.appName+(r?"&email="+r:"")+"&returnAddress=",u=null;backand.utils.isIE?(u=window.open("","",n),u.location=i):u=window.open(i,"socialpopup",n),u&&u.focus&&u.focus();var c=function(e){var t="message"===e.type?e.origin:e.url;t.indexOf(window.location.href)===-1&&s(o(0,"",[],"Unknown Origin Message"));var n="message"===e.type?JSON.parse(e.data):JSON.parse(e.newValue);window.removeEventListener(e.type,c,!1),u&&u.close&&u.close(),"storage"===e.type&&localStorage.removeItem(e.key),200!=n.status?s(n):a(n)};c=c.bind(u),window.addEventListener("storage",c,!1)})}function d(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"left=1, top=1, width=500, height=560";return new _.Promise(function(o,s){f(e,!1,r,"").then(function(e){return a(T.EVENTS.SIGNUP),m({accessToken:e.data.access_token})}).then(function(e){t&&t(e),o(e)}).catch(function(e){n&&n(e),s(e)})})}function h(e,t,n,r){return new _.Promise(function(s,i){backand.utils.http({url:T.URLS.socialSigninWithToken.replace("PROVIDER",e),method:"GET",params:{accessToken:t,appName:E.default.appName,signupIfNotSignedIn:!0}}).then(function(e){backand.utils.storage.set("user",{token:{Authorization:"Bearer "+e.data.access_token},details:e.data}),a(T.EVENTS.SIGNIN),E.default.runSocket&&backand.utils.socket.connect(backand.utils.storage.get("user").token.Authorization,E.default.anonymousToken,E.default.appName),backand.utils.http({url:T.URLS.objects+"/users",method:"GET",params:{filter:[{fieldName:"email",operator:"equals",value:e.data.username}]}}).then(function(t){var r=t.data.data[0],a=r.id,i=r.firstName,u=r.lastName,c=backand.utils.storage.get("user"),l={userId:a.toString(),firstName:i,lastName:u};backand.utils.storage.set("user",{token:c.token,details:k({},c.details,l)}),c=backand.utils.storage.get("user");var f=o(e.status,e.statusText,e.headers,c.details);n&&n(f),s(f)}).catch(function(e){r&&r(e),i(e)})}).catch(function(e){r&&r(e),i(e)})})}function p(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"left=1, top=1, width=500, height=560";return new _.Promise(function(s,i){f(e,!0,o,t).then(function(e){return a(T.EVENTS.SIGNUP),E.default.runSigninAfterSignup?m({accessToken:e.data.access_token}):(n&&n(e),void s(e))}).then(function(e){n&&n(e),s(e)}).catch(function(e){r&&r(e),i(e)})})}function m(e){return new _.Promise(function(t,n){var r=[];for(var o in e)r.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));r=r.join("&"),backand.utils.http({url:T.URLS.token,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:r+"&appName="+E.default.appName+"&grant_type=password"}).then(function(e){backand.utils.storage.set("user",{token:{Authorization:"Bearer "+e.data.access_token},details:e.data}),a(T.EVENTS.SIGNIN),E.default.runSocket&&backand.utils.socket.connect(backand.utils.storage.get("user").token.Authorization,E.default.anonymousToken,E.default.appName),t(e)}).catch(function(e){console.log(e),n(e)})})}function v(e,t,n){return backand.utils.http({url:T.URLS.requestResetPassword,method:"POST",data:{appName:E.default.appName,username:e}},t,n)}function g(e,t,n,r){return backand.utils.http({url:T.URLS.resetPassword,method:"POST",data:{newPassword:e,resetToken:t}},n,r)}function y(e,t,n,r){return backand.utils.http({url:T.URLS.changePassword,method:"POST",data:{oldPassword:e,newPassword:t}},n,r)}function b(e){return new _.Promise(function(t,n){backand.utils.http({url:T.URLS.signout,method:"GET"}),backand.utils.storage.remove("user"),E.default.runSocket&&backand.utils.socket.disconnect(),a(T.EVENTS.SIGNOUT),e&&e(o(200,"OK",[],backand.utils.storage.get("user"))),t(o(200,"OK",[],backand.utils.storage.get("user")))})}function w(e){return new _.Promise(function(t,n){e&&e(T.SOCIAL_PROVIDERS),t(T.SOCIAL_PROVIDERS)})}Object.defineProperty(n,"__esModule",{value:!0});var k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=e("es6-promise"),T=e("./../constants"),S=e("./../defaults"),E=r(S);n.default={__handleRefreshToken__:s,useAnonymousAuth:i,signin:u,signup:c,socialSignin:d,socialSigninWithToken:h,socialSignup:p,requestResetPassword:v,resetPassword:g,changePassword:y,signout:b,getSocialProviders:w}},{"./../constants":3,"./../defaults":4,"es6-promise":1}],8:[function(e,t,n){"use strict";function r(e,t,n,r,o,s){return backand.utils.http({url:a.URLS.objectsAction+"/"+e+"?name="+t,method:"POST",data:{filename:n,filedata:r.substr(r.indexOf(",")+1,r.length)}},o,s)}function o(e,t,n,r,o){return backand.utils.http({url:a.URLS.objectsAction+"/"+e+"?name="+t,method:"DELETE",data:{filename:n}},r,o)}Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../constants");n.default={upload:r,remove:o}},{"./../constants":3}],9:[function(e,t,n){"use strict";function r(e,t){var n={};for(var r in t)e.indexOf(r)!=-1&&(n[r]=t[r]);return n}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],o=arguments[3],a=["pageSize","pageNumber","filter","sort","search","exclude","deep","relatedObjects"];return backand.utils.http({url:f.URLS.objects+"/"+e,method:"GET",params:r(a,t)},null,o).then(function(e){var t=e.data.totalRows;return e.data=e.data.data,n&&n(e,t),e})}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments[3],a=arguments[4],s=["returnObject","deep"];return backand.utils.http({url:f.URLS.objects+"/"+e,method:"POST",data:t,params:r(s,n)},o,a)}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments[3],a=arguments[4],s=["deep","exclude","level"];return backand.utils.http({url:f.URLS.objects+"/"+e+"/"+t,method:"GET",params:r(s,n)},o,a)}function i(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments[4],s=arguments[5],i=["returnObject","deep"];return backand.utils.http({url:f.URLS.objects+"/"+e+"/"+t,method:"PUT",data:n,params:r(i,o)},a,s)}function u(e,t,n,r){return backand.utils.http({url:f.URLS.objects+"/"+e+"/"+t,method:"DELETE"},n,r)}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3],o=arguments[4];return backand.utils.http({url:f.URLS.objectsAction+"/"+e+"?name="+t,method:"GET",params:n},r,o)}function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments[4],a=arguments[5];return backand.utils.http({url:f.URLS.objectsAction+"/"+e+"?name="+t,method:"POST",data:n,params:r},o,a)}Object.defineProperty(n,"__esModule",{value:!0});var f=e("./../constants");n.default={getList:o,create:a,getOne:s,update:i,remove:u,action:{get:c,post:l}}},{"./../constants":3}],10:[function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],r=arguments[3];return backand.utils.http({url:a.URLS.query+"/"+e,method:"GET",params:t},n,r)}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3],o=arguments[4];return backand.utils.http({url:a.URLS.query+"/"+e,method:"POST",data:t,params:n},r,o)}Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../constants");n.default={get:r,post:o}},{"./../constants":3}],11:[function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return{status:e,statusText:t,headers:n,data:r}}function o(e,t){return new f.Promise(function(n,o){var a=backand.utils.storage.get("user");a?(e&&e(r(200,"OK",[],a.details)),n(r(200,"OK",[],a.details))):(t&&t(r(0,"",[],"No cached user found. authentication is required.")),o(r(0,"",[],"No cached user found. authentication is required.")))})}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?backand.utils.http({url:d.URLS.profile,method:"GET"}).then(function(n){var r=backand.utils.storage.get("user"),a=n.data;return backand.utils.storage.set("user",{token:r.token,details:l({},r.details,a)}),o(e,t)}):o(e,t)}function s(e,t){return o(null,t).then(function(t){return t.data=t.data.username,e&&e(t),t})}function i(){return o(null,ecb).then(function(e){return e.data=e.data.role,scb&&scb(e),e})}function u(){return o(null,ecb).then(function(e){return e.data=e.data.access_token,scb&&scb(e),e})}function c(){return o(null,ecb).then(function(e){return e.data=e.data.refresh_token,scb&&scb(e),e})}Object.defineProperty(n,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=e("es6-promise"),d=e("./../constants");n.default={getUserDetails:a,getUsername:s,getUserRole:i,getToken:u,getRefreshToken:c}},{"./../constants":3,"es6-promise":1}],12:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new c(e),n=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return c.prototype.request.apply(t,n)};return n.config=t.config,n}Object.defineProperty(n,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("es6-promise"),c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r(this,e),!window.XMLHttpRequest)throw new Error("XMLHttpRequest is not supported by this platform");this.config=s({method:"GET",headers:{},params:{},interceptors:{},withCredentials:!1,responseType:"json",auth:{username:null,password:null}},t)}return i(e,[{key:"_getHeaders",value:function(e){return e.split("\r\n").filter(function(e){return e}).map(function(e){var t={},n=e.split(":");return t[n[0]]=n[1],t})}},{key:"_getData",value:function(e,t){return e?e.indexOf("json")===-1?t:JSON.parse(t):t}},{key:"_createResponse",value:function(e,t){return{status:e.status,statusText:e.statusText,headers:this._getHeaders(e.getAllResponseHeaders()),config:t,data:this._getData(e.getResponseHeader("Content-Type"),e.responseText)}}},{key:"_handleError",value:function(e,t){return{status:0,statusText:"ERROR",headers:[],config:t,data:e}}},{key:"_encodeParams",value:function(e){var t=[];for(var n in e){var r=e[n];"object"===("undefined"==typeof r?"undefined":a(r))&&(r=JSON.stringify(r)),t.push(n+"="+encodeURIComponent(r))}return t.join("&")}},{key:"_setHeaders",value:function(e,t){for(var n in t)e.setRequestHeader(n,t[n])}},{key:"_setData",value:function(e,t){t?"object"!=("undefined"==typeof t?"undefined":a(t))?e.send(t):(e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.send(JSON.stringify(t))):e.send()}},{key:"request",value:function(e,t,n){var r=this;return new u.Promise(function(o,a){var i=new XMLHttpRequest,u=s({},r.config,e);if(!u.url||"string"!=typeof u.url||0===u.url.length){var c=r._handleError("url parameter is missing",u);n&&n(c),a(c)}u.withCredentials&&(i.withCredentials=!0),u.timeout&&(i.timeout=!0),u.interceptors.request&&u.interceptors.request.call(r,u);var l=r._encodeParams(u.params);i.open(u.method,""+(u.baseURL?u.baseURL+"/":"")+u.url+(l?"?"+l:""),!0,u.auth.username,u.auth.password),i.ontimeout=function(){var e=this._handleError("timeout",u);n&&n(e),a(e)},i.onabort=function(){var e=this._handleError("abort",u);n&&n(e),a(e)},i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE){var e=r._createResponse(i,u);200===e.status?u.interceptors.response?u.interceptors.response.call(r,e,u,o,a,t,n):(t&&t(e),o(e)):u.interceptors.responseError?u.interceptors.responseError.call(r,e,u,o,a,t,n):(n&&n(e),a(e))}},r._setHeaders(i,u.headers),r._setData(i,u.data)})}}]),e}(),l=o();l.create=function(e){return o(e)},n.default=l},{"es6-promise":1}],13:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){if(r(this,e),!window.io)throw new Error("runSocket is true but socketio-client is not included");this.url=t,this.onArr=[],this.socket=null}return o(e,[{key:"on",value:function(e,t){this.onArr.push({eventName:e,callback:t})}},{key:"connect",value:function(e,t,n){var r=this;this.disconnect(),this.socket=io.connect(this.url,{forceNew:!0}),this.socket.on("connect",function(){console.info("trying to establish a socket connection to "+n+" ..."),r.socket.emit("login",e,t,n)}),this.socket.on("authorized",function(){console.info("socket connected"),r.onArr.forEach(function(e){r.socket.on(e.eventName,function(t){e.callback(t)})})}),this.socket.on("notAuthorized",function(){setTimeout(function(){return r.disconnect()},1e3)}),this.socket.on("disconnect",function(){console.info("socket disconnect")}),this.socket.on("reconnecting",function(){console.info("socket reconnecting")}),this.socket.on("error",function(e){console.warn("error: "+e)})}},{key:"disconnect",value:function(){this.socket&&this.socket.close()}}]),e}();n.default=a},{}],14:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");
}Object.defineProperty(n,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(r=(s=i.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(r(this,e),!t)throw new Error("The provided Storage is not supported by this platform");if(!(t.setItem&&t.getItem&&t.removeItem&&t.clear))throw new Error("The provided Storage not implement the necessary functions");this.storage=t,this.prefix=n,this.delimiter="__________"}return s(e,[{key:"get",value:function(e){var t=this.storage.getItem(""+this.prefix+e);if(t){var n=t.split(this.delimiter),r=a(n,2),o=r[0],s=r[1];return"JSON"!=o?s:JSON.parse(s)}return t}},{key:"set",value:function(e,t){"object"!=("undefined"==typeof t?"undefined":o(t))?this.storage.setItem(""+this.prefix+e,"STRING"+this.delimiter+t):this.storage.setItem(""+this.prefix+e,"JSON"+this.delimiter+JSON.stringify(t))}},{key:"remove",value:function(e){this.storage.removeItem(""+this.prefix+e)}},{key:"clear",value:function(){for(var e=0;e<this.storage.length;e++)this.storage.getItem(this.storage.key(e)).indexOf(this.prefix)!=-1&&this.remove(this.storage.key(e))}}]),e}();n.default=i},{}]},{},[6])(6)});
//# sourceMappingURL=backand.min.js.map
